<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<link rel="manifest" href="manifest.webmanifest">
<title>Salon Accounting</title>
<link rel="stylesheet" href="styles.css">
</head>
<body>
<header>
  <h1>Salon Accounting</h1>
  <nav>
    <button class="tab-btn" data-tab="accounting">Accounting</button>
    <button class="tab-btn" data-tab="cost">Cost Analyzer</button>
    <button class="tab-btn" data-tab="import">Materials Import</button>
    <button class="tab-btn" data-tab="reports">Reports</button>
    <button class="tab-btn" data-tab="settings">Settings</button>
    <button class="tab-btn" data-tab="data">Data</button>
  </nav>
</header>

<main>
  <section id="accounting" class="tab active">
    <div class="card">
      <h2>Takings</h2>
      <div class="row">
        <label>Mode
          <select id="takings-mode">
            <option value="daily">Daily</option>
            <option value="weekly">Weekly total</option>
          </select>
        </label>
        <label id="date-label">Date
          <input type="date" id="takings-date"/>
        </label>
        <div id="week-range" class="row hidden">
          <label>Week Start <input type="date" id="week-start"/></label>
          <label>Week End <input type="date" id="week-end"/></label>
        </div>
      </div>
      <div class="grid-2">
        <label>Services Gross (€) <input type="number" id="services-gross" step="0.01" min="0"></label>
        <label>Retail Gross (€) <input type="number" id="retail-gross" step="0.01" min="0"></label>
        <label>Cash In (€) <input type="number" id="cash-in" step="0.01" min="0"></label>
        <label>Card In (€) <input type="number" id="card-in" step="0.01" min="0"></label>
        <label>Vouchers Sold (€) <input type="number" id="vouchers-in" step="0.01" min="0"></label>
        <label>Vouchers Redeemed (€) <input type="number" id="vouchers-out" step="0.01" min="0"></label>
        <label>Refunds (€) <input type="number" id="refunds" step="0.01" min="0"></label>
      </div>
      <div class="row">
        <button id="post-takings">Post Takings</button>
        <span id="takings-status" class="status"></span>
      </div>
      <p class="hint">Services = hair services performed. Retail = product sales. Engine will split VAT as per VAT mode in Settings.</p>
    </div>

    <div class="card">
      <h2>Expense</h2>
      <div class="grid-3">
        <label>Date <input type="date" id="exp-date"></label>
        <label>Supplier <input type="text" id="exp-supplier" placeholder="Supplier"></label>
        <label>Category
          <select id="exp-category">
            <option>Rent</option><option>Utilities</option><option>Supplies</option>
            <option>Wages</option><option>Loan Interest</option><option>Misc</option>
          </select>
        </label>
        <label>Net (€) <input type="number" id="exp-net" step="0.01" min="0"></label>
        <label>VAT Rate
          <select id="exp-vat">
            <option value="0">0%</option>
            <option value="0.135">13.5%</option>
            <option value="0.23" selected>23%</option>
          </select>
        </label>
        <label>Total (€) <input type="number" id="exp-total" step="0.01" min="0" placeholder="auto if Net+VAT"></label>
      </div>
      <div class="row">
        <button id="post-expense">Post Expense</button>
        <span id="expense-status" class="status"></span>
      </div>
    </div>
  </section>

  <section id="cost" class="tab">
    <div class="card">
      <h2>Cost Analyzer</h2>
      <div class="grid-3">
        <label>Service
          <select id="ca-service"></select>
        </label>
        <label>Minutes <input type="number" id="ca-minutes" min="0" step="1" value="60"></label>
        <label>Target Margin % <input type="number" id="ca-target" min="0" max="95" step="1" value="60"></label>
      </div>
      <div id="materials-list"></div>
      <div class="grid-3">
        <label>Overhead €/min <input type="number" id="ca-overhead" step="0.01" value="0.10"></label>
        <label>Labour €/min <input type="number" id="ca-labour" step="0.01" value="0.40"></label>
        <label>VAT Rate
          <select id="ca-vat">
            <option value="0.23">23%</option>
            <option value="0.135">13.5%</option>
            <option value="0">0%</option>
          </select>
        </label>
      </div>
      <div id="ca-output" class="kpis"></div>
    </div>
  </section>

  <section id="import" class="tab">
    <div class="card">
      <h2>Materials Import (CSV)</h2>
      <input type="file" id="csv-file" accept=".csv">
      <button id="parse-csv">Parse</button>
      <div id="csv-preview"></div>
      <button id="apply-import" disabled>Apply to Catalog</button>
      <p class="hint">Expected columns: service_name, material_name, units_per_service, unit, pack_size, pack_unit, pack_cost_eur, waste_factor_pct</p>
    </div>
  </section>

  <section id="reports" class="tab">
    <div class="card">
      <h2>Monthly Accounts</h2>
      <div class="row">
        <label>Month <input type="month" id="rep-month"></label>
        <button id="run-monthly">Run</button>
      </div>
      <div id="monthly-summary" class="kpis"></div>
    </div>
    <div class="card">
      <h2>Financial Statements</h2>
      <div class="row">
        <label>From <input type="date" id="rep-from"></label>
        <label>To <input type="date" id="rep-to"></label>
        <button id="run-reports">Run</button>
      </div>
      <div id="pl"></div>
      <div id="bs"></div>
      <div id="vat"></div>
    </div>
  </section>

  <section id="settings" class="tab">
    <div class="card">
      <h2>Settings</h2>
      <div class="grid-3">
        <label>VAT Mode
          <select id="vat-mode">
            <option value="include" selected>Prices include VAT</option>
            <option value="add">Add VAT on top</option>
          </select>
        </label>
        <label>Default VAT %
          <input type="number" id="vat-rate" value="23" step="0.5">
        </label>
        <label>Currency <input type="text" id="currency" value="EUR"></label>
      </div>
    </div>
  </section>

  <section id="data" class="tab">
    <div class="card">
      <h2>Data</h2>
      <div class="row">
        <button id="export-json">Export Backup</button>
        <input type="file" id="import-json" accept=".json">
        <button id="import-btn">Restore</button>
      </div>
      <pre id="data-log"></pre>
    </div>
  </section>
</main>

<script src="app.js"></script>
<script src="ledger.js"></script>
<script src="cost_analyzer.js"></script>
<script src="importer.js"></script>
<script src="reports.js"></script>
<script src="sw-register.js"></script>
</body>
</html>
