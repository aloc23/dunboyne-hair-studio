<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Salon Accounting</title>
  <link rel="manifest" href="manifest.webmanifest">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <header class="app-header">
    <h1>Salon Accounting</h1>
    <nav class="tabs">
      <button class="tab-btn" data-tab="accounting">Accounting</button>
      <button class="tab-btn" data-tab="expenses">Expenses</button>
      <button class="tab-btn" data-tab="cost">Cost Analyzer</button>
      <button class="tab-btn" data-tab="catalog">Service Catalog</button>
      <button class="tab-btn" data-tab="reports">Reports</button>
      <button class="tab-btn" data-tab="settings">Settings</button>
    </nav>
  </header>

  <main>
    <!-- Accounting -->
    <section id="tab-accounting" class="tab">
      <h2>Takings</h2>
      <div class="row">
        <label>Mode</label>
        <select id="takings-mode">
          <option value="daily">Daily</option>
          <option value="weekly">Weekly total</option>
        </select>
      </div>
      <div class="row">
        <label id="date-label">Date</label>
        <input id="takings-date" type="date" placeholder="YYYY-MM-DD"/>
        <span class="hint">If your browser doesn't show a picker, type YYYY-MM-DD</span>
      </div>
      <div class="row" id="week-range" style="display:none">
        <label>Week Ending</label>
        <input id="takings-week" type="date" placeholder="YYYY-MM-DD"/>
      </div>

      <details class="card">
        <summary>Service Lines (use for exact COGS)</summary>
        <div class="row">
          <label>Add service</label>
          <select id="service-select"></select>
          <input id="service-qty" type="number" min="1" value="1"/>
          <button id="add-service-line" class="btn">Add</button>
        </div>
        <table id="service-lines" class="table">
          <thead><tr><th>Service</th><th>Qty</th><th>Price</th><th>Total</th><th>COGS/unit</th><th>COGS</th><th></th></tr></thead>
          <tbody></tbody>
        </table>
      </details>

      <div class="grid two">
        <div class="card">
          <h3>Totals</h3>
          <div class="row"><label>Services Gross (€)</label><input id="services-gross" type="number" step="0.01"/></div>
          <div class="row"><label>Retail Gross (€)</label><input id="retail-gross" type="number" step="0.01"/></div>
          <div class="row"><label>Cash (€)</label><input id="cash" type="number" step="0.01"/></div>
          <div class="row"><label>Card (€)</label><input id="card" type="number" step="0.01"/></div>
        </div>
        <div class="card">
          <h3>VAT</h3>
          <div class="row">
            <label>VAT Mode</label>
            <select id="vat-mode">
              <option value="include">Prices include VAT</option>
              <option value="add">Add VAT on top</option>
            </select>
          </div>
          <div class="row"><label>VAT %</label><input id="vat-rate" type="number" step="0.01" value="23"/></div>
          <div class="kpis">
            <div><span>Net Sales</span><strong id="kpi-net">€0.00</strong></div>
            <div><span>VAT</span><strong id="kpi-vat">€0.00</strong></div>
            <div><span>COGS</span><strong id="kpi-cogs">€0.00</strong></div>
          </div>
        </div>
      </div>

      <div class="actions">
        <button id="post-takings" class="btn primary">Post Takings</button>
      </div>
      <div id="acc-msg" class="msg"></div>
    </section>

    <!-- Expenses -->
    <section id="tab-expenses" class="tab">
      <h2>Expenses</h2>
      <div class="row"><label>Date</label><input id="exp-date" type="date" placeholder="YYYY-MM-DD"></div>
      <div class="row"><label>Supplier</label><input id="exp-supplier" type="text"></div>
      <div class="row"><label>Category</label><input id="exp-category" type="text" placeholder="e.g., Utilities"></div>
      <div class="row"><label>Net (€)</label><input id="exp-net" type="number" step="0.01"></div>
      <div class="row"><label>VAT %</label><input id="exp-vat" type="number" step="0.01" value="23"></div>
      <div class="row"><label>Total (€)</label><input id="exp-total" type="number" step="0.01" readonly></div>
      <div class="actions"><button id="post-expense" class="btn">Post Expense</button></div>
      <div id="exp-msg" class="msg"></div>
      <h3>Recent Expenses</h3>
      <table class="table" id="expenses-table">
        <thead><tr><th>Date</th><th>Supplier</th><th>Category</th><th>Net</th><th>VAT</th><th>Total</th></tr></thead>
        <tbody></tbody>
      </table>
    </section>

    <!-- Cost Analyzer -->
    <section id="tab-cost" class="tab">
      <h2>Cost Analyzer</h2>
      <div class="row">
        <label>Select service</label>
        <select id="ca-service-select"></select>
        <button id="ca-load" class="btn">Load</button>
      </div>

      <details class="card" open>
        <summary>Working Table (editable inputs)</summary>
        <div class="grid three">
          <div class="row"><label>Retail Price (€)</label><input id="ca-price" type="number" step="0.01"></div>
          <div class="row"><label>Time (mins)</label><input id="ca-mins" type="number" step="1"></div>
          <div class="row"><label>Utilities €/hr</label><input id="ca-utilsHr" type="number" step="0.01"></div>
          <div class="row"><label>Product/Supplies (€)</label><input id="ca-supplies" type="number" step="0.01"></div>
          <div class="row"><label>Labour (€)</label><input id="ca-labour" type="number" step="0.01"></div>
          <div class="row"><label>Other Ops (€)</label><input id="ca-ops" type="number" step="0.01" value="0"></div>
        </div>
        <div class="actions">
          <button id="ca-recalc" class="btn">Recalculate</button>
          <button id="ca-add-to-catalog" class="btn">Save to Catalog</button>
        </div>
      </details>

      <details class="card">
        <summary>Review Table (computed, collapsible)</summary>
        <table class="table">
          <tbody>
            <tr><td>Utilities cost (mins × €/hr ÷ 60)</td><td id="rv-utils">€0.00</td></tr>
            <tr><td>Product/Supplies</td><td id="rv-supplies">€0.00</td></tr>
            <tr><td>Labour</td><td id="rv-labour">€0.00</td></tr>
            <tr><td>Other Ops</td><td id="rv-ops">€0.00</td></tr>
            <tr><td><strong>Total Cost</strong></td><td id="rv-total">€0.00</td></tr>
            <tr><td>Margin €</td><td id="rv-margin">€0.00</td></tr>
            <tr><td>Margin %</td><td id="rv-marginPct">0%</td></tr>
            <tr><td>Suggested Price @ 65% GM</td><td id="rv-suggest">€0.00</td></tr>
          </tbody>
        </table>
      </details>

      <div id="ca-msg" class="msg"></div>
    </section>

    <!-- Service Catalog -->
    <section id="tab-catalog" class="tab">
      <h2>Service Catalog</h2>
      <div class="actions">
        <button id="export-price-list" class="btn">Export Price List (Print/PDF)</button>
      </div>
      <table class="table" id="catalog-table">
        <thead><tr><th>Service</th><th>Price</th><th>Mins</th><th>Supplies</th><th>Utilities/hr</th><th>Labour</th><th>Total Cost</th><th></th></tr></thead>
        <tbody></tbody>
      </table>
      <h3>Add / Edit</h3>
      <div class="grid three">
        <input id="svc-name" placeholder="Service name">
        <input id="svc-price" type="number" step="0.01" placeholder="Retail price">
        <input id="svc-mins" type="number" step="1" placeholder="Time (mins)">
        <input id="svc-supplies" type="number" step="0.01" placeholder="Product/Supplies (€)">
        <input id="svc-utilsHr" type="number" step="0.01" placeholder="Utilities €/hr">
        <input id="svc-labour" type="number" step="0.01" placeholder="Labour (€)">
        <input id="svc-total" type="number" step="0.01" placeholder="Total cost">
      </div>
      <div class="actions">
        <button id="svc-save" class="btn primary">Save Service</button>
      </div>
      <div id="cat-msg" class="msg"></div>
    </section>

    <!-- Reports -->
    <section id="tab-reports" class="tab">
      <h2>Reports</h2>
      <div class="row"><label>From</label><input id="rep-from" type="date" placeholder="YYYY-MM-DD"></div>
      <div class="row"><label>To</label><input id="rep-to" type="date" placeholder="YYYY-MM-DD"></div>
      <div class="actions"><button id="run-reports" class="btn">Run</button></div>
      <div class="grid two">
        <div class="card">
          <h3>Monthly Accounts (One‑Pager)</h3>
          <table class="table" id="monthly-table">
            <tbody></tbody>
          </table>
        </div>
        <div class="card">
          <h3>Financial Statements</h3>
          <table class="table" id="pl-table"><thead><tr><th>P&L</th><th>€</th></tr></thead><tbody></tbody></table>
          <table class="table" id="bs-table"><thead><tr><th>Balance Sheet</th><th>€</th></tr></thead><tbody></tbody></table>
          <table class="table" id="vat-table"><thead><tr><th>VAT Summary</th><th>€</th></tr></thead><tbody></tbody></table>
        </div>
      </div>
    </section>

    <!-- Settings -->
    <section id="tab-settings" class="tab">
      <h2>Settings</h2>
      <div class="row"><label>Default VAT %</label><input id="set-vat" type="number" step="0.01" value="23"></div>
      <div class="row"><label>VAT Mode</label>
        <select id="set-vat-mode">
          <option value="include">Include VAT</option>
          <option value="add">Add VAT</option>
        </select>
      </div>
      <details class="card">
        <summary>Utilities (€/hr breakdown)</summary>
        <table class="table" id="utils-table">
          <thead><tr><th>Item</th><th>Monthly</th><th>Yearly</th><th>€/hr</th></tr></thead>
          <tbody></tbody>
        </table>
        <div class="row"><label>Total €/hr</label><input id="utils-total" type="number" step="0.01"></div>
      </details>
      <div class="actions">
        <button id="save-settings" class="btn">Save Settings</button>
      </div>
      <div id="set-msg" class="msg"></div>
    </section>
  </main>

  <footer class="footer">Local‑first • Offline‑ready • Your data stays on this device</footer>

  <script src="seed.js"></script>
  <script src="store.js"></script>
  <script src="logic.js"></script>
  <script src="app.js"></script>
</body>
</html>
